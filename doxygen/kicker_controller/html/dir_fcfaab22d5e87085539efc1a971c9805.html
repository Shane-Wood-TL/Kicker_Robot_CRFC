<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kicker Controller: managed_components/espressif__esp-now/examples/solution Directory Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Kicker Controller
   </div>
   <div id="projectbrief">Senior Design Project 2025 for the Controller for the Kicker Robot</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_230ff1e69d1001871a4401f345fc5388.html">managed_components</a></li><li class="navelem"><a class="el" href="dir_53b0c73583c5ec3ac167a7c3a40a70e1.html">espressif__esp-now</a></li><li class="navelem"><a class="el" href="dir_a284544a182ea467cb5e8d18d1856e3a.html">examples</a></li><li class="navelem"><a class="el" href="dir_fcfaab22d5e87085539efc1a971c9805.html">solution</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">solution Directory Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="subdirs" name="subdirs"></a>
Directories</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="iconfclosed"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_a5e897f851ef339516c20af9619a70b2.html">components</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top"><span class="iconfclosed"></span>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="dir_73f40ac4e6c36e9de7d4156682f83d9c.html">main</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This example provides the solution to use <code>ESP-NOW</code> multiple features in one project.</p>
<ul>
<li>Provision WiFi on initiator device through APP and then configure responders WiFi network by espnow provisioning.</li>
<li>Control lights on responder devices through button on initiator device.</li>
<li>Debug the responder devices through commands and get log from responder devices.</li>
<li>Upgrade responder devices through ESP-NOW.</li>
<li>Security handshake and communication between initiator device and responder devices.</li>
</ul>
<h1><a class="anchor" id="autotoc_md128"></a>
Hardware Required</h1>
<p>This example can run on any ESP32 series boards and at least two development boards are required.</p>
<p>A button needs to be connected to a GPIO pin to configure WiFi network.</p>
<p>A <code>RGB LED</code> is needed if the development board doesn't have the RGB LED component. The light is used to indicate WiFi status and control status.</p>
<p>The GPIO pins that drive the button or the light can be configured and modified in <a href="main/app_main.c">app_main.c</a>.</p>
<h1><a class="anchor" id="autotoc_md129"></a>
Configuration</h1>
<p>Open the project configuration menu (<code>idf.py menuconfig</code>) to set following configurations under <code>Example Configuration</code> Options:</p>
<ul>
<li>Set <code>ESP-NOW Mode</code> of example to be <code>Initiator Mode</code> or <code>Responder Mode</code></li>
<li>Set <code>Enable ESPNOW Control</code> to enable ESP-NOW <code>control</code> function</li>
<li>Set <code>Enable ESPNOW Debug</code> to enable ESP-NOW <code>debug</code> function</li>
<li>Set <code>Enable ESPNOW OTA</code> to enable ESP-NOW <code>OTA</code> function</li>
<li>Set <code>Enable WiFi Provision over ESP-NOW</code> to enable ESP-NOW <code>provision</code> function</li>
<li>Set <code>Enable ESPNOW Security</code> to enable ESP-NOW <code>security</code> function<ul>
<li>Set <code>Proof Possession</code> string to authorize session.</li>
</ul>
</li>
<li>Under <code>WIFI Provision Configuration</code>, set <code>BLE</code> or <code>SoftAP</code> provisioning.</li>
</ul>
<blockquote class="doxtable">
<p>Note that, the initiator/responder board will enable some functions as default. Only the initiator board can enable <code>WiFi Provision</code> function, and enabled by default. </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md130"></a>
How to Use the Example</h1>
<p>Before program the firmware to flash, please firstly use <code>erase_flash</code> to erase the entire flash memory.</p>
<div class="fragment"><div class="line">idf.py erase_flash flash</div>
</div><!-- fragment --><p>The following steps will show the default functions when using default configurations. If disable some functions, the steps will be different.</p>
<h2><a class="anchor" id="autotoc_md131"></a>
Step 1: Build &amp; Flash &amp; Run responder boards</h2>
<p>When build the project, you can change the firmware name by:</p>
<div class="fragment"><div class="line">cd examples/solution/</div>
<div class="line">rm -rf build/</div>
<div class="line">export PROJECT_NAME=Resp</div>
<div class="line">idf.py build</div>
</div><!-- fragment --><p>You can find the firmware in <code>build/Resp.bin</code>.</p>
<p>If the device runs for the first time, it doesn't have the APP key and can't encrypt/decrypt ESP-NOW data until getting key from initiator board. If the device has stored the APP key, it will read APP key from flash and use the key to encrypt/decrypt ESP-NOW data.</p>
<h2><a class="anchor" id="autotoc_md132"></a>
Step 2: Build &amp; Flash &amp; Run initiator board</h2>
<p>If <code>PROJECT_NAME</code> is not defined, the default firmware name is <code>Init.bin</code>. If you want to change the firmware name, please refer to Step 1.</p>
<p>When initiator board runs, it will start security handshake with responders.</p>
<p>If the initiator board runs for the first time, it will generate a random APP key and store it to flash. Or if it has stored the APP key, it will get the APP key from flash.</p>
<p>After handshake is success, responders will get APP key and store the key to flash.</p>
<p>Then the initiator and responders can communicate ESP-NOW application data in security mode.</p>
<h2><a class="anchor" id="autotoc_md133"></a>
Step 3: WiFi Provision on initiator board</h2>
<p>If the device runs for the first time, it has not stored the router info and will not connect to AP. If it has stored the AP info, it will connect to router when WiFi start.</p>
<p>Double click the provision button if the device is not configurated and the light will turn <code>white</code>.</p>
<p>Use APP to scan the QR code to provision the initiator board, please refer to <a href="https://github.com/espressif/esp-idf/blob/v4.4.1/examples/provisioning/wifi_prov_mgr/README.md">README</a></p>
<p>After initiator board has connected to router, the light will turn <code>green</code> , or turn <code>red</code> if connection failed. If connecting router succeeds, it will start 30s provision beacon broadcast.</p>
<p>If you want to erase the WiFi config info, please long press the provision button, it will restore WiFi config and restart the board.</p>
<h2><a class="anchor" id="autotoc_md134"></a>
Step 4: WiFi Provision on responder board</h2>
<p>Single click the provision button on initiator board, it will also start 30s provision beacon broadcast.</p>
<p>Double click the provision button on responder board, it will enter ESP-NOW provision status and the light will turn <code>white</code>. After connecting router succeeds, the light will turn <code>green</code> or turn <code>red</code> if connection failed.</p>
<p>If you want to erase the WiFi config info, please long press the provision button on responder board, it will restore WiFi config and restart the board.</p>
<h2><a class="anchor" id="autotoc_md135"></a>
Step 5: Control responder boards</h2>
<p>Use <code>Boot button</code> on initiator board to bind, control and unbind the responder light. Please refer to <a class="el" href="managed__components_2espressif____esp-now_2examples_2control_2_r_e_a_d_m_e_8md.html">README</a></p>
<h2><a class="anchor" id="autotoc_md136"></a>
Step 6: Debug responder boards</h2>
<p>The initiator board can debug responder boards through <code>Command</code> command running on other devices, and receives running log from responder devices. Please refer to <a class="el" href="managed__components_2espressif____esp-now_2examples_2wireless__debug_2_r_e_a_d_m_e_8md.html">README</a></p>
<p>The responder board will store log in flash and send through ESP-NOW data. It also implements the function of transferring log data to the TCP server on the HTTP network(Default closed. Open the function in <code>menuconfig</code>-&gt;<code>Example Configuration</code>).</p>
<h2><a class="anchor" id="autotoc_md137"></a>
Step 7: OTA through Commands</h2>
<p>The initiator board can download new firmware from HTTP server and sends the firmware to responder devices through ESP-NOW. Please refer to OTA command in <a class="el" href="managed__components_2espressif____esp-now_2examples_2wireless__debug_2_r_e_a_d_m_e_8md.html">README</a>.</p>
<h1><a class="anchor" id="autotoc_md138"></a>
Example Output</h1>
<p>Note that the output, in particular the order of the output, may vary depending on the environment.</p>
<p>Console output of the initiator:</p>
<div class="fragment"><div class="line">I (669) wifi:Set ps type: 0</div>
<div class="line"> </div>
<div class="line">I (672) phy_init: phy_version 909,156dee4,Apr  7 2022,20:27:09</div>
<div class="line">I (757) wifi:mode : sta (7c:df:a1:76:42:38)</div>
<div class="line">I (757) wifi:enable tsf</div>
<div class="line">I (758) ESPNOW: espnow [version: 1.0] init</div>
<div class="line">I (759) phy: chan:1,max_power:80</div>
<div class="line">I (760) phy: chan:2,max_power:80</div>
<div class="line">... ...</div>
<div class="line">I (807) phy: chan:14,max_power:80</div>
<div class="line">I (812) gpio: GPIO[2]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:0 </div>
<div class="line">I (821) gpio: GPIO[9]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:0 </div>
<div class="line">I (843) espnow_console: Partition size: total: 52961, used: 0</div>
<div class="line">I (845) espnow_console: Command history enabled</div>
<div class="line">esp32c3&gt; W (3333) init: espnow wait security num: 1</div>
<div class="line">I (3333) espnow_sec_init: count: 0, Secure_initiator_send, requested_num: 1, unfinished_num: 1, successed_num: 0</div>
<div class="line">I (4096) init: App key is sent to the device to complete, Spend time: 3265ms, Scan time: 2502ms</div>
<div class="line">I (4097) init: Devices security completed, successed_num: 1, unfinished_num: 0</div>
<div class="line">[7c:df:a1:86:d8:24][1][-20]: I (12854) espnow_sec_resp: Get APP key</div>
<div class="line">I (5566) restart_func: num: 12, reason: 1, crash: 1</div>
<div class="line">esp32c3&gt; </div>
<div class="line">esp32c3&gt; I (148161) app: WiFi provisioning press</div>
<div class="line">W (148161) BTDM_INIT: esp_bt_mem_release not implemented, return OK</div>
<div class="line">I (148162) wifi_prov_scheme_ble: BT memory released</div>
<div class="line">I (148173) prov: Starting provisioning</div>
<div class="line">I (148174) wifi:Set ps type: 1</div>
<div class="line"> </div>
<div class="line">W (148175) BTDM_INIT: esp_bt_controller_mem_release not implemented, return OK</div>
<div class="line">I (148186) BTDM_INIT: BT controller compile version [d913766]</div>
<div class="line">I (148198) BTDM_INIT: Bluetooth MAC: 7c:df:a1:76:42:3a</div>
<div class="line"> </div>
<div class="line">I (148202) wifi_prov_mgr: Provisioning started with service name : PROV_764238 </div>
<div class="line">I (148203) prov: Scan this QR code from the provisioning application for Provisioning.</div>
<div class="line">I (148214) QRCODE: Encoding below text with ECC LVL 0 &amp; QR Code Version 10</div>
<div class="line">I (148225) QRCODE: {&quot;ver&quot;:&quot;v1&quot;,&quot;name&quot;:&quot;PROV_764238&quot;,&quot;pop&quot;:&quot;abcd1234&quot;,&quot;transport&quot;:&quot;ble&quot;}</div>
<div class="line">                                    </div>
<div class="line">  █▀▀▀▀▀█ ▀▀▀█▄█   ▀▀▄ ▀▄ █ █▀▀▀▀▀█   </div>
<div class="line">  █ ███ █  ▀▄█ █▄ ▀▄█ ▄██▀  █ ███ █   </div>
<div class="line">  █ ▀▀▀ █  ▄▀█▀▄▀ ▀█▄▀ ██▄▀ █ ▀▀▀ █   </div>
<div class="line">  ▀▀▀▀▀▀▀ █▄▀ █▄█▄█ ▀ █ ▀▄▀ ▀▀▀▀▀▀▀   </div>
<div class="line">  ▀█▄▀▀ ▀▄▄▀▄ ▀▄ ▄▀▀▀█  ▀▄▄ ▀▄▄ ▄▄▀   </div>
<div class="line">   ▄▄▄▄█▀▄█▀  ▀▀▀▀▄▄█    ▀ █  ▄█▄█▀   </div>
<div class="line">   █▄▄▀▀▀█▄▀█ ▄▄██▄ ▀▀▀▄█  ▄▀█ ▀▄▄▀   </div>
<div class="line">  █ ▄▀█▀▀█▄▄  ▄ ▄█▄▀▀█▄▀█▄▀▄▄█  ▄   </div>
<div class="line">  █▄▀▀█▀▀▄▄ ▄█▀▀ █▀▄▀▄▀ ▄█  ███▄ ██   </div>
<div class="line">  ▄ ██▀█▀▀  ▄▄▀▄███▀▄▀█ ▀█ █▀▀ ▀▄▄▀   </div>
<div class="line">  ██ █  ▀ ██ ▀▄▄█▄▀▀█▄█▄█▀▀█ ▀▄ ▄▀  </div>
<div class="line">  █ ▀▄ ▄▀██▀ █▄  ▀█▄█▄▀▀█▀█ ▄█ ▀▄▄█   </div>
<div class="line">  ▀▀▀▀▀▀▀▀▄  ▀▀▄▄██▄█▀█ ▀██▀▀▀█▄▄▀  </div>
<div class="line">  █▀▀▀▀▀█   ██▀▀▀██ ▄▀▄ █▄█ ▀ █ ▄ ▄   </div>
<div class="line">  █ ███ █ █▀▀▄█▀▀█▀▄█▄▄ ▀██▀▀▀▀▄▄▀▀   </div>
<div class="line">  █ ▀▀▀ █ ▄ ▀▀ ▄█▀█ █▀ ▀▀███▄▀█ █▄█   </div>
<div class="line">  ▀▀▀▀▀▀▀ ▀ ▀▀  ▀▀ ▀     ▀▀▀▀▀▀     </div>
<div class="line">                                    </div>
<div class="line"> </div>
<div class="line">I (148421) prov: If QR code is not visible, copy paste the below URL in a browser.</div>
<div class="line">https://espressif.github.io/esp-jumpstart/qrcode.html?data={&quot;ver&quot;:&quot;v1&quot;,&quot;name&quot;:&quot;PROV_764238&quot;,&quot;pop&quot;:&quot;abcd1234&quot;,&quot;transport&quot;:&quot;ble&quot;}</div>
<div class="line">I (148203) protocomm_nimble: BLE Host Task Started</div>
<div class="line">I (148447) NimBLE: GAP procedure initiated: stop advertising.</div>
<div class="line"> </div>
<div class="line">I (148459) NimBLE: GAP procedure initiated: advertise; </div>
<div class="line">I (148460) NimBLE: disc_mode=2</div>
<div class="line">I (148470) NimBLE:  adv_channel_map=0 own_addr_type=0 adv_filter_policy=0 adv_itvl_min=256 adv_itvl_max=256</div>
<div class="line">I (148471) NimBLE: </div>
<div class="line"> </div>
<div class="line">I (148203) prov: Provisioning started</div>
<div class="line">I (199375) protocomm_nimble: mtu update event; conn_handle=1 cid=4 mtu=256</div>
<div class="line"> </div>
<div class="line">I (226354) prov: Received Wi-Fi credentials</div>
<div class="line">        SSID     : myssid</div>
<div class="line">        Password : mypassword</div>
<div class="line">I (228322) wifi:new:&lt;5,1&gt;, old:&lt;1,0&gt;, ap:&lt;255,255&gt;, sta:&lt;5,1&gt;, prof:1</div>
<div class="line">I (228971) wifi:state: init -&gt; auth (b0)</div>
<div class="line">I (228993) wifi:state: auth -&gt; assoc (0)</div>
<div class="line">I (229009) wifi:state: assoc -&gt; run (10)</div>
<div class="line">I (229031) wifi:connected with myssid, aid = 7, channel 5, 40U, bssid = e8:9f:80:da:ab:8f</div>
<div class="line">I (229032) wifi:security: WPA2-PSK, phy: bgn, rssi: -64</div>
<div class="line">I (229046) wifi:pm start, type: 1</div>
<div class="line"> </div>
<div class="line">I (229047) wifi:set rx beacon pti, rx_bcn_pti: 14, bcn_timeout: 14, mt_pti: 25000, mt_time: 10000</div>
<div class="line">I (229052) wifi:BcnInt:102400, DTIM:2</div>
<div class="line">W (229063) wifi:&lt;ba-add&gt;idx:0 (ifx:0, e8:9f:80:da:ab:8f), tid:0, ssn:0, winSize:64</div>
<div class="line">I (230563) prov: Connected with IP Address:192.168.0.42</div>
<div class="line">I (230564) esp_netif_handlers: sta ip: 192.168.0.42, mask: 255.255.255.0, gw: 192.168.0.1</div>
<div class="line">I (230575) init: got ip:192.168.0.42</div>
<div class="line">I (230576) wifi_prov_mgr: STA Got IP</div>
<div class="line">I (230577) prov: Provisioning successful</div>
<div class="line">I (230577) espnow_prov: Responder beacon start, timer: 30s</div>
<div class="line">I (232598) NimBLE: GAP procedure initiated: stop advertising.</div>
<div class="line"> </div>
<div class="line">I (232603) NimBLE: GAP procedure initiated: stop advertising.</div>
<div class="line"> </div>
<div class="line">I (232604) NimBLE: GAP procedure initiated: terminate connection; conn_handle=1 hci_reason=19</div>
<div class="line"> </div>
<div class="line">E (232676) protocomm_nimble: Error setting advertisement data; rc = 30</div>
<div class="line">W (232679) Timer: Timer not stopped</div>
<div class="line">W (232680) Timer: Timer not stopped</div>
<div class="line">I (232685) wifi_prov_mgr: Provisioning stopped</div>
<div class="line">W (232686) BTDM_INIT: esp_bt_mem_release not implemented, return OK</div>
<div class="line">I (232697) wifi_prov_scheme_ble: BTDM memory released</div>
<div class="line">I (232708) wifi:Set ps type: 0</div>
<div class="line"> </div>
<div class="line">I (260677) espnow_prov: Responder beacon end</div>
<div class="line">I (273601) app: ESPNOW provisioning press</div>
<div class="line">I (273601) espnow_prov: Responder beacon start, timer: 30s</div>
<div class="line">I (274203) init: MAC: 7c:df:a1:86:d8:24, Channel: 5, RSSI: -22, Product_id: initiator_test, Device Name: , Auth Mode: 0, device_secret: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-23]: I (282958) resp: MAC: 7c:df:a1:76:42:38, Channel: 5, RSSI: -25, Product_id: responder_test, Device Name: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-29]: I (283485) wifi:[7c:df:a1:86:d8:24][5][-30]: new:&lt;5,1&gt;, old:&lt;5,0&gt;, ap:&lt;255,255&gt;, sta:&lt;5,1&gt;, prof:1[7c:df:a1:86:d8:24][5][-29]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-27]: I (284082) wifi:[7c:df:a1:86:d8:24][5][-27]: state: init -&gt; auth (b0)[7c:df:a1:86:d8:24][5][-24]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-28]: I (284087) wifi:[7c:df:a1:86:d8:24][5][-31]: state: auth -&gt; assoc (0)[7c:df:a1:86:d8:24][5][-35]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-36]: I (284114) wifi:[7c:df:a1:86:d8:24][5][-32]: state: assoc -&gt; run (10)[7c:df:a1:86:d8:24][5][-31]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-29]: I (284293) wifi:[7c:df:a1:86:d8:24][5][-30]: connected with myssid, aid = 8, channel 5, 40U, bssid = e8:9f:80:da:ab:8f[7c:df:a1:86:d8:24][5][-30]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-31]: I (284295) wifi:[7c:df:a1:86:d8:24][5][-31]: security: WPA2-PSK, phy: bgn, rssi: -68[7c:df:a1:86:d8:24][5][-34]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-36]: I (284306) wifi:[7c:df:a1:86:d8:24][5][-38]: pm start, type: 0</div>
<div class="line">[7c:df:a1:86:d8:24][5][-40]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-44]: I (284307) wifi:[7c:df:a1:86:d8:24][5][-42]: set rx beacon pti, rx_bcn_pti: 14, bcn_timeout: 14, mt_pti: 25000, mt_time: 10000[7c:df:a1:86:d8:24][5][-37]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-37]: I (284308) wifi:[7c:df:a1:86:d8:24][5][-37]: BcnInt:102400, DTIM:2[7c:df:a1:86:d8:24][5][-37]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-37]: W (284533) wifi:[7c:df:a1:86:d8:24][5][-37]: &lt;ba-add&gt;idx:0 (ifx:0, e8:9f:80:da:ab:8f), tid:0, ssn:0, winSize:64[7c:df:a1:86:d8:24][5][-35]: </div>
<div class="line">[7c:df:a1:86:d8:24][5][-33]: I (285584) esp_netif_handlers: sta ip: 192.168.0.45, mask: 255.255.255.0, gw: 192.168.0.1</div>
<div class="line">[7c:df:a1:86:d8:24][5][-35]: I (285585) resp: got ip:192.168.0.45</div>
<div class="line">esp32c3&gt; </div>
<div class="line">esp32c3&gt; </div>
<div class="line">esp32c3&gt; I (303701) espnow_prov: Responder beacon end</div>
<div class="line">I (307341) app: WiFi provisioning press</div>
<div class="line">I (331541) app: initiator bind press</div>
<div class="line">[7c:df:a1:86:d8:24][5][-22]: I (340306) espnow_ctrl: bind, esp_log_timestamp: 340306, timestamp: 30802, rssi: -25, rssi: -55</div>
<div class="line">[7c:df:a1:86:d8:24][5][-22]: I (340307) control_func: addr: 7c:df:a1:76:42:38, initiator_type: 2, initiator_value: 1</div>
<div class="line">[7c:df:a1:86:d8:24][5][-23]: I (340319) app: bind, uuid: 7c:df:a1:76:42:38, initiator_type: 513</div>
<div class="line">I (336321) app: initiator send press</div>
<div class="line">[7c:df:a1:86:d8:24][5][-20]: I (345086) app: espnow_ctrl_responder_recv, initiator_attribute: 513, responder_attribute: 1, value: 0</div>
<div class="line">I (338166) app: initiator send press</div>
<div class="line">[7c:df:a1:86:d8:24][5][-19]: I (346931) app: espnow_ctrl_responder_recv, initiator_attribute: 513, responder_attribute: 1, value: 1</div>
<div class="line">... ...</div>
<div class="line">I (346686) app: initiator unbind press</div>
<div class="line">[7c:df:a1:86:d8:24][5][-20]: I (355451) app: unbind, uuid: 7c:df:a1:76:42:38, initiator_type: 513</div>
</div><!-- fragment --><p>Console output of the responder:</p>
<div class="fragment"><div class="line">I (653) phy_init: phy_version 909,156dee4,Apr  7 2022,20:27:09</div>
<div class="line">I (738) wifi:mode : sta (7c:df:a1:86:d8:24)</div>
<div class="line">I (738) wifi:enable tsf</div>
<div class="line">I (739) ESPNOW: espnow [version: 1.0] init</div>
<div class="line">I (740) phy: chan:1,max_power:80</div>
<div class="line">I (741) phy: chan:2,max_power:80</div>
<div class="line">... ...</div>
<div class="line">I (788) phy: chan:14,max_power:80</div>
<div class="line">I (793) gpio: GPIO[2]| InputEn: 1| OutputEn: 0| OpenDrain: 0| Pullup: 1| Pulldown: 0| Intr:0 </div>
<div class="line">I (802) esp_timesync: Initializing SNTP. Using the SNTP server: pool.ntp.org</div>
<div class="line">I (827) espnow_log_flash: LOG flash initialized successfully</div>
<div class="line">I (828) espnow_log_flash: Log save partition subtype: label: log_info, addr:0x3d0000, offset: 0, size: 65536</div>
<div class="line">I (839) espnow_log: log initialized successfully</div>
<div class="line">esp32c3&gt; I (5542) restart_func: num: 3, reason: 1, crash: 1</div>
<div class="line">I (12854) espnow_sec_resp: Get APP key</div>
<div class="line">esp32c3&gt; </div>
<div class="line">esp32c3&gt; I (269307) app: WiFi provisioning press</div>
<div class="line">I (269310) phy: chan:1,max_power:80</div>
<div class="line">I (269310) phy: chan:2,max_power:80</div>
<div class="line">... ...</div>
<div class="line">I (269358) phy: chan:14,max_power:80</div>
<div class="line">I (282958) resp: MAC: 7c:df:a1:76:42:38, Channel: 5, RSSI: -25, Product_id: responder_test, Device Name: </div>
<div class="line">I (282994) resp: MAC: 7c:df:a1:76:42:38, Channel: 5, RSSI: -25, wifi_mode: 0, ssid: myssid, password: mypassword, token: </div>
<div class="line">I (283064) resp: provisioning initiator exit</div>
<div class="line">I (283485) wifi:new:&lt;5,1&gt;, old:&lt;5,0&gt;, ap:&lt;255,255&gt;, sta:&lt;5,1&gt;, prof:1</div>
<div class="line">I (284082) wifi:state: init -&gt; auth (b0)</div>
<div class="line">I (284087) wifi:state: auth -&gt; assoc (0)</div>
<div class="line">I (284114) wifi:state: assoc -&gt; run (10)</div>
<div class="line">I (284293) wifi:connected with myssid, aid = 8, channel 5, 40U, bssid = e8:9f:80:da:ab:8f</div>
<div class="line">I (284295) wifi:security: WPA2-PSK, phy: bgn, rssi: -68</div>
<div class="line">I (284306) wifi:pm start, type: 0</div>
<div class="line"> </div>
<div class="line">I (284307) wifi:set rx beacon pti, rx_bcn_pti: 14, bcn_timeout: 14, mt_pti: 25000, mt_time: 10000</div>
<div class="line">I (284308) wifi:BcnInt:102400, DTIM:2</div>
<div class="line">W (284533) wifi:&lt;ba-add&gt;idx:0 (ifx:0, e8:9f:80:da:ab:8f), tid:0, ssn:0, winSize:64</div>
<div class="line">I (285584) esp_netif_handlers: sta ip: 192.168.0.45, mask: 255.255.255.0, gw: 192.168.0.1</div>
<div class="line">I (285585) resp: got ip:192.168.0.45</div>
<div class="line">esp32c3&gt; </div>
<div class="line">esp32c3&gt; </div>
<div class="line">esp32c3&gt; I (340306) espnow_ctrl: bind, esp_log_timestamp: 340306, timestamp: 30802, rssi: -25, rssi: -55</div>
<div class="line">I (340307) control_func: addr: 7c:df:a1:76:42:38, initiator_type: 2, initiator_value: 1</div>
<div class="line">I (340319) app: bind, uuid: 7c:df:a1:76:42:38, initiator_type: 513</div>
<div class="line">I (345086) app: espnow_ctrl_responder_recv, initiator_attribute: 513, responder_attribute: 1, value: 0</div>
<div class="line">I (346931) app: espnow_ctrl_responder_recv, initiator_attribute: 513, responder_attribute: 1, value: 1</div>
<div class="line">... ...</div>
<div class="line">I (355451) app: unbind, uuid: 7c:df:a1:76:42:38, initiator_type: 513</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md139"></a>
Troubleshooting</h1>
<ul>
<li>Errors <code>E (14798) espnow_sec: Failed at mbedtls_ccm_auth_decrypt with error code : -15</code>. It means authentication failed. Maybe initiator board erases its flash and generates a new security key, not the same with responder. If you see this error please erase responder board flash and reset responder board, the security handshake will execute again after reset initiator board. The responder board will get the security key to keep the same with initiator board.</li>
<li>Build with ESP32-C3 failed with 'ADC_BUTTON_WIDTH' undeclared. Please change the defination as the following in <a href="managed_components/espressif__button/button_adc.c">button_adc.c</a></li>
</ul>
<div class="fragment"><div class="line">#if CONFIG_IDF_TARGET_ESP32 || CONFIG_IDF_TARGET_ESP32C3</div>
<div class="line">#define ADC_BUTTON_WIDTH       ADC_WIDTH_BIT_12</div>
<div class="line">#elif CONFIG_IDF_TARGET_ESP32S2</div>
<div class="line">#define ADC_BUTTON_WIDTH       ADC_WIDTH_BIT_13</div>
<div class="line">#endif</div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
